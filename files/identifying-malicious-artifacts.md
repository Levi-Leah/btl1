# Identifying and Removing Malicious Artifacts

* malicious artifact is an object with malicious purposes
  * e.g., a piece of malicious software (malware) that is installed on a system, a running process, a scheduled task, a registry entry, a text file generated by a keylogger, etc.
* ensure that we remove all malicious artifacts during the incident response process, because if we miss something, the attackers may still have some degree of control over the system
  * e.g., if there's a backdoor hardening the system won't work
* **Identifying Artifacts**
  * common places to look and see if anything looks suspicious:
    * active network connections, user accounts, file downloads, running processes, scheduled tasks, and registry entries
  * some manual checks include:
    * Check for suspicious or unknown processes running in the system
      * For Windows systems, Sysinternals Process Explorer is a very powerful task manager that can show processes that try to mask themselves as ordinary system processes
    * netstat utility and Sysinternals’ Process Monitor are an excellent combination to help track down malware that is attempting to “call home” or attempting to spread.
    * Rootkit Revealer, is very useful in detecting Rootkits or malware that uses advanced techniques in order to mask its presence on a system
* **Removing Artifacts**
  * **Reimaging Affected Systems**
    * easiest ways to completely recover a system from any kind of infection is to reimage it from a backup
      * provided there is a backup before the infection occurs
    * downside is that all data after the pre-infection backup was taken will be lost
  * **Anti-Malware Solutions**
    * in the event of a malware infection, if the antivirus didn’t detect the malware to start with it may struggle to find associated malicious artifacts
    * Next-Generation AV might be more useful here, as it doesn’t take the same approach of traditional antivirus methods
      * goes beyond known file-based malware signatures and heuristics and can utilize predictive analytics powered by machine learning and artificial intelligence to detect, and respond to new threats that would normally go undetected file-less malware that hides in memory
    * In the case of an advanced malware infection, it is likely better to proceed with the re-imaging method of removing artifacts
  * **Bootable Tools**
    * don’t require installation and can be run from a CD or USB drive in order to prevent them from being affected by malware residing on the system
      * McAfee provides the stand-alone Stinger Malware removal tool
      * Microsoft has the Malicious Software Removal Tool
      * Avira offers the “Avira Rescue System“
  * **Removing Malicious Files**
    * e.g., offensive cyber tooling or malware samples
    * will prevent them being used either accidentally by a legitimate user of the system, or if the system is compromised again in the future
  * **Deleting Persistence Mechanisms**
    * e.g. Windows Registry key that is used to execute a malicious file at set intervals, such as a reverse shell that allows the attacker to connect into the system remotely, deleting this registry key will stop this activity
    * Other examples include removing Scheduled Tasks on Windows systems, or Cron jobs on Linux-based systems